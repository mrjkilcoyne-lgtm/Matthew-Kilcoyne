// ── Security Score ──────────────────────────────────────────────
export interface SecurityScore {
  overall: number; // 0-100
  grade: 'A+' | 'A' | 'B' | 'C' | 'D' | 'F';
  breakdown: {
    osVersion: number;
    patchLevel: number;
    permissions: number;
    networkSecurity: number;
    appSecurity: number;
    stalkerwareRisk: number;
  };
  lastScanned: string; // ISO date
}

// ── CVE / Vulnerability ────────────────────────────────────────
export interface CVEEntry {
  id: string; // e.g. CVE-2024-12345
  severity: 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW' | 'INFORMATIONAL';
  description: string;
  affectedVersions: string[];
  patchedIn?: string;
  publishedDate: string;
  references: string[];
  cvssScore?: number;
  exploitAvailable: boolean;
}

export interface VulnerabilityScanResult {
  deviceModel: string;
  osVersion: string;
  patchLevel: string;
  vulnerabilities: CVEEntry[];
  totalFound: number;
  criticalCount: number;
  highCount: number;
  mediumCount: number;
  lowCount: number;
  scanDate: string;
}

// ── App Risk Assessment ────────────────────────────────────────
export interface AppRiskProfile {
  packageName: string;
  appName: string;
  version: string;
  riskScore: number; // 0-100
  riskLevel: 'SAFE' | 'LOW' | 'MEDIUM' | 'HIGH' | 'DANGEROUS';
  permissions: AppPermission[];
  behaviors: AppBehavior[];
  isStalkerware: boolean;
  isKnownMalware: boolean;
  networkActivity: NetworkConnection[];
}

export interface AppPermission {
  name: string;
  description: string;
  dangerLevel: 'NORMAL' | 'DANGEROUS' | 'SIGNATURE';
  granted: boolean;
  category: 'CAMERA' | 'MICROPHONE' | 'LOCATION' | 'CONTACTS' | 'STORAGE' | 'PHONE' | 'SMS' | 'NETWORK' | 'SYSTEM' | 'OTHER';
}

export interface AppBehavior {
  type: 'DATA_COLLECTION' | 'BACKGROUND_ACTIVITY' | 'NETWORK_TRAFFIC' | 'DEVICE_ADMIN' | 'OVERLAY' | 'ACCESSIBILITY' | 'BOOT_RECEIVER' | 'CRYPTO_MINING';
  description: string;
  severity: 'INFO' | 'WARNING' | 'DANGER';
}

// ── Network / Firewall ─────────────────────────────────────────
export interface NetworkConnection {
  appName: string;
  packageName: string;
  remoteHost: string;
  remotePort: number;
  protocol: 'TCP' | 'UDP';
  direction: 'OUTBOUND' | 'INBOUND';
  bytesTransferred: number;
  timestamp: string;
  blocked: boolean;
  country?: string;
}

export interface FirewallRule {
  id: string;
  packageName: string;
  appName: string;
  allowWifi: boolean;
  allowCellular: boolean;
  allowVpn: boolean;
  blockedHosts: string[];
  enabled: boolean;
}

// ── URL / Phishing ─────────────────────────────────────────────
export interface URLScanResult {
  url: string;
  isSafe: boolean;
  threatType?: 'PHISHING' | 'MALWARE' | 'SCAM' | 'SPAM' | 'SUSPICIOUS';
  riskScore: number;
  sslValid: boolean;
  sslIssuer?: string;
  sslExpiry?: string;
  whoisRegistrar?: string;
  whoisCreated?: string;
  whoisCountry?: string;
  domainAge?: number; // days
  redirectChain: string[];
  scanDate: string;
}

// ── Wi-Fi ──────────────────────────────────────────────────────
export interface WiFiScanResult {
  ssid: string;
  bssid: string;
  encryption: 'WPA3' | 'WPA2' | 'WPA' | 'WEP' | 'OPEN';
  signalStrength: number;
  frequency: number;
  securityScore: number;
  risks: string[];
  routerVulnerabilities: CVEEntry[];
  isPublic: boolean;
}

// ── OSINT ──────────────────────────────────────────────────────
export interface OSINTResult {
  query: string;
  type: 'EMAIL' | 'PHONE' | 'USERNAME' | 'IP';
  breachesFound: DataBreach[];
  totalBreaches: number;
  exposedData: string[];
  riskLevel: 'NONE' | 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';
}

export interface DataBreach {
  name: string;
  date: string;
  recordsExposed: number;
  dataTypes: string[];
  description: string;
  source: string;
}

// ── File Scanner ───────────────────────────────────────────────
export interface FileScanResult {
  fileName: string;
  fileSize: number;
  fileHash: {
    md5: string;
    sha1: string;
    sha256: string;
  };
  isMalicious: boolean;
  detections: string[];
  scanEngines: number;
  positiveDetections: number;
  scanDate: string;
}

// ── Device Comparison ──────────────────────────────────────────
export interface DeviceProfile {
  brand: string;
  model: string;
  osVersion: string;
  patchLevel: string;
  securityScore: number;
  knownVulnerabilities: number;
  updateFrequency: 'MONTHLY' | 'QUARTERLY' | 'YEARLY' | 'IRREGULAR' | 'EOL';
  supportedUntil?: string;
}

// ── Security History ───────────────────────────────────────────
export interface SecurityHistoryEntry {
  date: string;
  score: number;
  grade: string;
  events: SecurityEvent[];
}

export interface SecurityEvent {
  type: 'SCAN' | 'THREAT_DETECTED' | 'THREAT_RESOLVED' | 'APP_INSTALLED' | 'APP_REMOVED' | 'PERMISSION_CHANGED' | 'OS_UPDATE' | 'SETTINGS_CHANGED';
  description: string;
  severity: 'INFO' | 'WARNING' | 'DANGER';
  timestamp: string;
}

// ── AI Assistant ───────────────────────────────────────────────
export interface AIMessage {
  id: string;
  role: 'user' | 'assistant' | 'system';
  content: string;
  timestamp: string;
  attachments?: {
    type: 'scan_result' | 'cve' | 'app_risk';
    data: unknown;
  }[];
}

export interface AISecurityReport {
  summary: string;
  riskLevel: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';
  findings: AIFinding[];
  recommendations: string[];
  attackSurface: string;
  generatedAt: string;
}

export interface AIFinding {
  title: string;
  description: string;
  severity: 'INFO' | 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';
  remediation: string;
  category: string;
}

// ── Dashboard ──────────────────────────────────────────────────
export interface DashboardData {
  securityScore: SecurityScore;
  recentThreats: SecurityEvent[];
  installedApps: number;
  riskyApps: number;
  stalkerwareDetected: number;
  lastScanDate: string;
  pendingUpdates: number;
  activeFirewallRules: number;
  blockedConnections: number;
}
