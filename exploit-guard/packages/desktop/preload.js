const { contextBridge, ipcRenderer } = require('electron');

/**
 * Expose native desktop capabilities to the web app
 * via a secure context bridge
 */
contextBridge.exposeInMainWorld('exploitGuardDesktop', {
  getSystemInfo: () => ipcRenderer.invoke('get-system-info'),
  getNetworkInterfaces: () => ipcRenderer.invoke('get-network-interfaces'),
  onQuickScan: (callback) => {
    ipcRenderer.on('quick-scan', callback);
    return () => ipcRenderer.removeListener('quick-scan', callback);
  },
  platform: process.platform,
  isDesktop: true,
});
